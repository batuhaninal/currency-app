@using System.Text.Json
@using Microsoft.Extensions.Primitives
@model CurrencyFilterViewModel
@{
    var query = Context.Request.Query.ToDictionary(k => k.Key.ToLower(), v => v.Value);

    StringValues categoryIds;
    string[]? selectedCategories = query.TryGetValue("categoryid", out categoryIds)
    ? categoryIds.ToArray()
    : null;

    // Min - Max fiyat parametreleri
    string minPPrice = query.TryGetValue("minpurchaseprice", out var minPVal) ? minPVal.ToString() : "";
    string maxPPrice = query.TryGetValue("maxpurchaseprice", out var maxPVal) ? maxPVal.ToString() : "";

    string minSPrice = query.TryGetValue("minsaleprice", out var minSVal) ? minSVal.ToString() : "";
    string maxSPrice = query.TryGetValue("maxsaleprice", out var maxSVal) ? maxSVal.ToString() : "";

}

<div class="modal fade" id="eu-filter-currency-popup" tabindex="-1" role="dialog"
    aria-labelledby="exampleModalLongTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class='modal-header bg-info'>
                <h5 class="modal-title">Birim Filtrele</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <form method="get" class="d-inline">
                <div class="modal-body" id="modal-body">
                    @await Html.PartialAsync("_DropdownTool", new DropdownModel(
                    "Kategori Seciniz",
                                        "eu-filter-category-dropdown",
                                        "CategoryId",
                                        "js-eu-category-tool-multiple",
                                        Model.Categories,
                                        true,
                                        selectedCategories
                                        ))

                    <div class="mt-3">
                        <label for="minPurchasePrice" class="form-label">Min Satın Alım Fiyatı</label>
                        <input type="number" step="0.01" class="form-control" id="minPurchasePrice"
                            name="minPurchasePrice" value="@minPPrice" />

                        <label for="maxPurchasePrice" class="form-label mt-2">Max Satın Alım Fiyatı</label>
                        <input type="number" step="0.01" class="form-control" id="maxPurchasePrice"
                            name="maxPurchasePrice" value="@maxPPrice" />
                    </div>

                    <div class="mt-3">
                        <label for="minSalePrice" class="form-label">Min Satis Fiyatı</label>
                        <input type="number" step="0.01" class="form-control" id="minSalePrice" name="minSalePrice"
                            value="@minSPrice" />

                        <label for="maxSalePrice" class="form-label mt-2">Max Satis Fiyatı</label>
                        <input type="number" step="0.01" class="form-control" id="maxSalePrice" name="maxSalePrice"
                            value="@maxSPrice" />
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Kapat</button>
                    <a asp-area="" asp-controller="Currencies" asp-action="Index" class="btn btn-danger">Temizle</a>
                    <button type="submit" class="btn btn-info">Filtreleri Uygula</button>
                </div>
            </form>
        </div>
    </div>
</div>
